<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASN Lookup from JSON</title>
    <script>
        // Hàm để lấy giá trị của tham số từ URL
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // Hàm để load dữ liệu JSON từ file cục bộ
        async function lookupASN() {
            const asnCode = getQueryParam('as');  // Lấy giá trị ASN từ URL

            // Kiểm tra nếu không có ASN trong URL
            if (!asnCode) {
                document.body.innerHTML = '<p>Error: ASN parameter is missing in URL.</p>';
                return;
            }

            try {
                // Load file JSON cục bộ
                const response = await fetch('asn_data.json');
                
                // Kiểm tra phản hồi có thành công không
                if (!response.ok) {
                    document.body.innerHTML = `<p>Error: Failed to load JSON file (status ${response.status})</p>`;
                    return;
                }

                // Lấy dữ liệu JSON
                const data = await response.json();

                // Tìm kiếm ASN trong dữ liệu
                const asnEntry = data.find(entry => entry.ASN === `AS${asnCode}`);

                // Nếu tìm thấy, hiển thị kết quả, nếu không thì báo lỗi
                if (asnEntry) {
                    document.body.innerHTML = `<pre>${JSON.stringify(asnEntry, null, 4)}</pre>`;
                } else {
                    document.body.innerHTML = `<p>Error: ASN not found.</p>`;
                }
            } catch (error) {
                document.body.innerHTML = `<p>Error: ${error.message}</p>`;
            }
        }

        // Thực hiện lookup khi trang được tải
        window.onload = lookupASN;
    </script>
</head>
<body>
    <!-- Kết quả sẽ hiển thị ở đây -->
</body>
</html>
